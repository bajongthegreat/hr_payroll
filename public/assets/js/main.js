function escapeRegExp(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function replaceAll(e,t,a){return e.replace(new RegExp(escapeRegExp(t),"g"),a)}function __parseTime(e){var t=e.match(/(\d+):(\d+)(?: )?(am|pm)?/i);if(null==t)return!1;var a=parseInt(t[1],10),n=parseInt(t[2],10),i=t[3]?t[3].toUpperCase():null;return"AM"===i&&12==a&&(a=0),"PM"===i&&12!=a&&(a+=12),{hh:a,mm:n}}function __getHour(e){var t=e,a=t/1e3/60/60;t-=1e3*a*60*60;var n=Math.floor(t/1e3/60);t-=1e3*n*60;var i=Math.floor(t/1e3);return t-=1e3*i,a}function calculateTotalHours(e,t,a,n,i){var o=0,l=0,m=0;time_in_am=__parseTime(e),time_out_am=__parseTime(t),time_in_pm=__parseTime(a),time_out_pm=__parseTime(n);var r=new Date(2e3,0,1,time_in_am.hh,time_in_am.mm),s=new Date(2e3,0,1,time_out_am.hh,time_out_am.mm),c=new Date(2e3,0,1,time_in_pm.hh,time_in_pm.mm),d=new Date(2e3,0,1,time_out_pm.hh,time_out_pm.mm),u=__getHour(s-r),h=__getHour(d-c);return"ns"==i&&(o=getNightPemium_10_03(a,n,e,t)),total=h+u,total>8&&(m=total-8),{total:total,np_10_03:o,np_03_06:l,overtime:m}}function arrayHasOwnIndex(e,t){return e.hasOwnProperty(t)&&/^0$|^[1-9]\d*$/.test(t)&&4294967294>=t}function getNightPemium_10_03(e,t,a,n){var i=moment("22:00","HH:mm"),o=moment(t,"HH:mm"),l=o.diff(i),m=moment(a,"HH:mm"),r=moment("03:00","HH:mm"),s=moment(n,"HH:mm");if(__parseTime(n).hh<3)var c=s.diff(m);else var c=r.diff(m);return __getHour(l)+__getHour(c)}function getJSONdata(e,t){return mapped=jQuery.map(e,function(e,a){return a==t?e:void 0}),mapped.length>0?mapped[0]:void 0}function __addRow(e,t,a){var n=document.getElementById(e),i=n.rows.length,o=n.insertRow(i),l=a;console.log("starting add row...");for(var m=0;t-1>=m;m++){o=n.insertRow(m),console.log("rows to add "+t+"...");for(var r=0;r<=l.length-1;r++){var s=o.insertCell(r),c=document.createElement(l[r].type);if(l[r].hasOwnProperty("class"))for(var d=0;d<l[r].class.length;d++)c.className=c.className+" "+l[r].class[d];if(l[r].hasOwnProperty("data"))for(var u=0;u<l[r].data.length;u++)c.setAttribute("data-name","hello");c.id=l[r].name,c.name=l[r].name,c.type="text",s.appendChild(c)}o=n.insertRow(i+1)}setTimeout(function(){$("#time_in_am, #time_out_am, #time_in_pm, #time_out_pm").datetimepicker({use24hours:!0,pickTime:!0,pickDate:!1,minuteStepping:15})},2e3)}function addRow_pe(e,t){var a=document.getElementById(e),n=a.rows.length,i=a.insertRow(n),o=[],l=[],m=[],r=[];$.ajax({async:!1,type:"GET",url:_globalObj._baseURL+"/syncdata?get=medical_findings",success:function(e){o=e}}),$.ajax({async:!1,type:"GET",url:_globalObj._baseURL+"/syncdata?get=recommendations",success:function(e){m=e}});for(key in o)arrayHasOwnIndex(o,key)&&(l[key]=o[key]);for(key in m)arrayHasOwnIndex(m,key)&&(r[key]=m[key]);l.push("None");for(var s=["employee_work_id","medical_findings","recommendation","remarks"],c=0;t-1>=c;c++){i=a.insertRow(c);for(var d=0;d<=s.length-1;++d){var u=i.insertCell(d);if("medical_findings"==s[d])for(var h=document.createElement("select"),p=0;p<=l.length-1;p++)void 0!=l[p]&&(opt=document.createElement("option"),opt.value=p,"None"==l[p]&&(opt.value="None"),opt.text=l[p],h.appendChild(opt),"None"==l[p]&&(opt.selected=!0));else if("recommendation"==s[d])for(var h=document.createElement("select"),p=0;p<=r.length-1;p++)void 0!=r[p]&&(opt=document.createElement("option"),opt.value=r[p],opt.text=r[p],h.appendChild(opt));else{var h=document.createElement("input");h.type="text","employee_work_id"==s[d]&&(h.className=h.className+"searcheable")}h.name=s[d],h.dataset.name=s[d],h.classList.add("form-control"),u.appendChild(h)}}$(".rowcount").html(""+n)}function fillBlankTable(e,t,a,n){"undefined"==typeof a&&(a="id"),"undefined"==typeof n&&(n="pe");var i=t;if(i.length>0){var o=i.length,l=document.getElementById(e),m=(l.rows.length,l.rows);"pe"==n&&addRow_pe(e,i.length,[]),console.log(i);for(var r=0;o>r;++r)if(m[r].cells.length>0)for(var s=0;s<m[r].cells.length;s++)if(m[r].dataset.id=i[r][a],element=m[r].cells[s].getElementsByTagName("input"),void 0!=element[0]&&(elementName=element[0].getAttribute("name"),element[0].value=i[r][elementName],element[0].dataset.defaultValue=i[r][elementName]),select=m[r].cells[s].getElementsByTagName("select"),void 0!=select[0]){if(elementName=select[0].getAttribute("name"),"undefined"==typeof i[r][elementName]||!i[r][elementName])continue;select[0].value=i[r][elementName]}}}function OpenInNewTab(e){window.open(e,"_blank")}var myApp=function(e){this.mainURL=e,this.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},this.hasHash=function(){var e=location.hash;return hashValue=e.split("=",2),2==hashValue.length?!0:!1},this.getHash=function(e){var t=location.hash;return hashValue=t.split("=",2),2==hashValue.length?"#"+e==hashValue[0]?hashValue[1]:!1:void 0},this.personName=function(e,t){return"lastname_first"==t?this.fullNameStartLastname(e.firstname,e.lastname,e.middlename):this.fullname(e.firstname,e.lastname,e.middlename)},this.fullname=function(e,t,a){return e+" "+a+" "+t},this.fullNameStartLastname=function(e,t,a){return t+", "+e+" "+a[0]+"."},this.dateToString=function(e){e.getMonth(),e.getFullYear(),e.getDate()},this.getSelectOptions=function(e,t,a,n){$.ajax({type:"GET",url:e,data:{id:t,output:"json",select:"true"},success:function(e){console.log(e);var t="";$.each(e,function(e,a){t+=n==e?'<option value="'+e+'" selected>'+a+"</option>":'<option value="'+e+'">'+a+"</option>"}),$("#"+a).html(t).trigger("change")}})},this.getCheckBox=function(e,t,a,n,i,o){$.ajax({type:"GET",url:e,data:{id:t,output:"json",select:"true"},success:function(e){var l="";$.each(e,function(e,a){if(l+='<div class="form-group">',l+='<label for="'+a+'" class="col-sm-2">'+a+"</label>",l+='<div class="col-sm-1">',null!=i){checked=!1;for(var m=i.length-1;m>=0;m--)i[m]==e&&(checked=!0);l+=checked===!0?'<input type="checkbox" data-parent="'+t+'" class="'+o+'" name="'+n+'" value="'+e+'" checked>':'<input type="checkbox" data-parent="'+t+'" class="'+o+'" name="'+n+'" value="'+e+'">'}else l+='<input type="checkbox" data-parent="'+t+'" class="'+o+'" name="'+n+'" value="'+e+'">';l+="</div></div>"}),console.log(l),$("#"+a).html(l).trigger("change"),$("."+a).html(l).trigger("change")}})}},__in_array=function(e,t){for(var a=!1,n=t.length-1;n>=0;n--)t[n]==e&&(a=!0);return a},__hasClass=function(e,t){var a="/"+t+"/";return e.className.match(a)?!0:!1},__indexOf=function(e){return indexOf="function"==typeof Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t=-1,a=-1;for(t=0;t<this.length;t++)if(this[t]===e){a=t;break}return a},indexOf.call(this,e)};$(document).ready(function(){$("#_applicants_date_hired, #_applicants_birthdate, #date_conducted, .text-date").datetimepicker({pickTime:!1}),$("#birth_date").datetimepicker({maxDate:"12/31/1998",defaultDate:"1998-01-01",pickTime:!1});var e=void 0;$(".filter-item").on("click",function(){{var t=($(this).data("category"),$(this).data("fieldvalue"),$(this).closest("ul"));t.data("limit")}void 0!=typeof e&&clearTimeout(e);var a=(t.find(":checkbox:checked").length,{});$(".filter-list").each(function(){var e=[];$(this).find("li :checkbox:checked").each(function(){e.push($(this).data("fieldvalue"))}),e.length>0&&(a[$(this).data("category")]=e)}),e=setTimeout(function(){window.location.href=encodeURI("?filterby="+JSON.stringify(a))},3500)}),$(document).on("click","._deleteItem",function(e){e.preventDefault();var t=$(this),a=t.data("employee_id"),n=t.data("url");$.ajax({type:"DELETE",url:n,data:{id:a},success:function(e){"1"==e&&t.closest("tr").fadeOut(255)}})})});var dtrModule=function(){this.getTableData=function(e){for(var t={},a={},n=value="",i=0;i<e.rows.length;i++){t={},t.id=e.rows[i].dataset.id;for(var o=0;o<e.rows[i].cells.length;o++)console.log(e.rows[i].cells[o].children[0].dataset.name),"input"==e.rows[i].cells[o].children[0].tagName.toLowerCase()?(n=e.rows[i].cells[o].children[0].dataset.name,value=e.rows[i].cells[o].children[0].value):void 0!=e.rows[i].cells[o].children[0].children[0]&&(n=e.rows[i].cells[o].children[0].children[0].dataset.name,value=e.rows[i].cells[o].children[0].children[0].value),t[n]=value;void 0!=t.employee_work_id&&(console.log(t.employee_work_id),""!=t.employee_work_id&&(a[i]=t))}return a},this.calculateTotalHours=function(e,t,a,n,i){var o=0,l=0,m=0;time_in_am=__parseTime(e),time_out_am=__parseTime(t),time_in_pm=__parseTime(a),time_out_pm=__parseTime(n);var r=new Date(2e3,0,1,time_in_am.hh,time_in_am.mm),s=new Date(2e3,0,1,time_out_am.hh,time_out_am.mm),c=new Date(2e3,0,1,time_in_pm.hh,time_in_pm.mm),d=new Date(2e3,0,1,time_out_pm.hh,time_out_pm.mm),u=__getHour(s-r),h=__getHour(d-c);return"ns"==i&&(o=getNightPemium_10_03(a,n,e,t)),total=h+u,total>8&&(m=total-8),{total:total,np_10_03:o,np_03_06:l,overtime:m}},this.getNightPemium_10_03=function(e,t,a,n){var i=moment("22:00","HH:mm"),o=moment(t,"HH:mm"),l=o.diff(i),m=moment(a,"HH:mm"),r=moment("03:00","HH:mm"),s=moment(n,"HH:mm");if(__parseTime(n).hh<3)var c=s.diff(m);else var c=r.diff(m);return __getHour(l)+__getHour(c)},this.changeShift=function(e,t,a){console.log(a),console.log("from Module"),"ds"==e?(console.log("Day shift"),$("#def_timeout_am").val("11:00"),$("._am").text("Time out AM"),$("#def_timein_pm").val("12:00"),$("._pm").text("Time in PM"),$(t+" tr").each(function(){var e=$(this).find('input[name="time_in_am"]'),t=$(this).find('input[name="time_out_am"]'),a=$(this).find('input[name="time_in_pm"]'),n=$(this).find('input[name="time_out_pm"]');time_in_am_clone=e.clone(!0),time_out_am_clone=t.clone(!0),time_in_pm_clone=a.clone(!0),time_out_pm_clone=n.clone(!0),a.replaceWith(time_in_am_clone),e.replaceWith(time_in_pm_clone),t.replaceWith(time_out_pm_clone),n.replaceWith(time_out_am_clone)}),$("._amth").html("AM"),$("._pmth").html("PM")):"ns"==e&&(console.log("Night shift"),$("#def_timeout_am").val("00:00"),$("._am").text("Time in AM"),$("#def_timein_pm").val("23:00"),$("._pm").text("Time out PM"),$(t+" tr").each(function(){var e=$(this).find('input[name="time_in_am"]'),t=$(this).find('input[name="time_out_am"]'),a=$(this).find('input[name="time_in_pm"]'),n=$(this).find('input[name="time_out_pm"]');time_in_am_clone=e.clone(!0),time_out_am_clone=t.clone(!0),time_in_pm_clone=a.clone(!0),time_out_pm_clone=n.clone(!0),a.replaceWith(time_in_am_clone),e.replaceWith(time_in_pm_clone),t.replaceWith(time_out_pm_clone),n.replaceWith(time_out_am_clone)}),$("._amth").html("PM"),$("._pmth").html("AM"))},this.initializer=function(e){$("#department_id").val(e.oldDepartment),0!=e.oldDepartment&&(hrApp.getSelectOptions(_globalObj._baseURL+"/positions/positionsByDepartment",e.oldDepartment,"position_id",e.oldPosition),"ns"==e.oldShift&&_dtrModule.changeShift(e.oldShift))},this.handlers=function(){$(".shift_label").on("click",function(){var e=$("#shift").parent();e.is(":visible")?e.hide():e.show()}),$("#department_id").change(function(){var e=$(this).find(":selected").val(),t=null;$("#position_id").parent().parent().show(),hrApp.getSelectOptions(_globalObj._baseURL+"/positions/positionsByDepartment",e,"position_id",t)}),$("#shift").on("change",function(){var e=$(this).val(),t="";_dtrModule.changeShift(e,"#medical_examination_information_table"),t="ds"==e?'<span class="label label-warning">Day shift</span>':'<span class="label label-info">Night shift</span>',$(".shift_label").html(t)}),$("#def_timeout_am").on("change",function(){var e=$("#shift").val();if("ds"==e){var t=$('input[name="time_out_am"]'),a=$(this).val();$.each(t,function(){$(this).val(a)})}else if("ns"==e){var t=$('input[name="time_in_am"]'),a=$(this).val();$.each(t,function(){$(this).val(a)})}}),$("#def_timein_pm").on("change",function(){var e=$("#shift").val();if("ds"==e){var t=$('input[name="time_in_pm"]'),a=$(this).val();$.each(t,function(){$(this).val(a)})}else if("ns"==e){var n=$('input[name="time_out_pm"]'),a=$(this).val();$.each(n,function(){$(this).val(a)})}}),$('input[name="show_full_dtr"]').on("change",function(){var e=$('input[name="time_out_am"]'),t=$('input[name="time_in_pm"]'),a=$('input[name="time_in_am"]'),n=$('input[name="time_out_pm"]');if(1==$(this).prop("checked"))show_full_dtr=!0,$.each(e,function(){$(this).parent().parent().fadeIn()}),$.each(t,function(){$(this).parent().parent().fadeIn()}),$.each(a,function(){$(this).parent().parent().fadeIn()}),$.each(n,function(){$(this).parent().parent().fadeIn()}),$("#header_timeout_am").fadeIn(250),$("#header_timein_pm").fadeIn(250),$(".timelabel").fadeIn();else{show_full_dtr=!1;var i=$("#shift").val();"ds"==i?($("#header_timeout_am").fadeOut(250),$("#header_timein_pm").fadeOut(250),$(".timelabel").fadeOut(),$.each(e,function(){var e=$(this),t=e.parent().parent().parent().find('input[name="time_in_pm"]').val(),a=e.parent().parent().parent().find('input[name="time_out_pm"]').val();console.log(a),"00:00"==t&&"00:00"==a?e.parent().parent().parent().find('input[name="time_out_pm"]').parent().parent().fadeOut():e.parent().parent().fadeOut()}),$.each(t,function(){var e=$(this),t=e.parent().parent().parent().find('input[name="time_in_am"]').val(),a=e.parent().parent().parent().find('input[name="time_out_am"]').val();console.log(a),"00:00"==t&&"00:00"==a?e.parent().parent().parent().find('input[name="time_in_am"]').parent().parent().fadeOut():e.parent().parent().fadeOut()})):"ns"==i&&($("#header_timeout_am").fadeOut(250),$("#header_timein_pm").fadeOut(250),$(".timelabel").fadeOut(),$.each(n,function(){var e=$(this);e.parent().parent().fadeOut()}),$.each(a,function(){var e=$(this);e.parent().parent().fadeOut()}))}})}};$(".ajax-modal").on("click",function(e){var t=$(this).attr("href"),a=$(this).data("title"),n=$(this).data();$("#ajax-modal-form #ajax-modal-save").data("href",t),$.ajax({type:"GET",url:t,data:n,beforeSend:function(){$("#ajax-modal-form #ajax-modal-save").html("Fetching View...").prop("disabled",!0)},success:function(e){$("#ajax-modal-form #ajax-modal-save").html("Accept").prop("disabled",!1),$("#ajax-modal-form .modal-title").html(a),$("#ajax-modal-form .modal-body").html(e)}}),$("#ajax-modal-form").modal("show"),e.preventDefault()}),$("#ajax-modal-form #ajax-modal-save").on("click",function(){var e=$("#ajax-modal-form #ajax-modal-save");e.html("Processing...").prop("disabled",!0);var t=$(this).data("href"),a={},n=$("#ajax-modal-form .modal-body input");$.each(n,function(){a[$(this).attr("name")]="checkbox"==$(this).attr("type")?this.checked:$(this).val()}),console.log(a),$.ajax({type:"POST",data:a,url:t,beforeSend:function(){},success:function(t){var a=JSON.parse(t);void 0!=a.request_type?($("#ajax-modal-form .modal-body").html("File is downloading. If download does not start, please try again. <br><br> If file does not download at all after trying several times, please contact the web developer."),e.html("Preparing..."),setTimeout(function(){location.href=a.path,e.html("Downloading...").prop("disabled",!0)},1800)):$("#ajax-modal-form .modal-body").html(t)},error:function(){$("#ajax-modal-form .modal-body").html("Something went wrong. Please re-run this modal."),e.html("Accept").prop("disabled",!0)}})}),jQuery.fn.extend({disable:function(e){return this.each(function(){this.disabled=e})}}),!function(e){e.fn.classes=function(t){var a=[];if(e.each(this,function(e,t){var n=t.className.split(/\s+/);for(var i in n){var o=n[i];-1===a.indexOf(o)&&a.push(o)}}),"function"==typeof t)for(var n in a)t(a[n]);return a}}(jQuery),function(){$(".dashboard-sidebar li a").on("click",function(e){var t=$(this).data("location"),a=$(this).data("type");$.ajax({type:"GET",url:t,beforeSend:function(){$(".canHaveAjaxContent").css("opacity",.1),$(".dashboard-main-content  .loading").fadeIn();for(var e=0;10>e;e++)10==e&&$(".dashboard-main-content  .loading").html("Please wait a little longer...")},success:function(e){$(".canHaveAjaxContent").html(e)},complete:function(){$(".canHaveAjaxContent").css("opacity",100),window.location.hash=a,$(".dashboard-main-content  .loading").fadeOut(),$("#calendar").fullCalendar({handleWindowResize:!0,changeView:"month ",events:_globalObj._baseURL+"/holidays/?fullcalendar=true"})}}),e.preventDefault()})}();