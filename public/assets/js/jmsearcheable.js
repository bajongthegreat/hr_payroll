!function(t){t.fn.jmSearcheable=function(e){var i=t(this);settings=t.extend({url:"#",urlWithID:!1,idSeparator:"?",idField:"id",delay:50,format:"",containerWrapper:"#searchResultContainer",fadeIn:"fast",fadeOut:"fast",keyEvent:"keyup",fields:[""],fieldTag:"div",limit:10,itemIcon:"",loaderImage:""},e),t(settings.containerWrapper).hide(),beginSearch=function(){t.ajax({url:settings.url,type:"GET",data:{src:i.val(),output:"json",limit:settings.limit},beforeSend:function(){var e="";toggleContainer(),""!=settings.loaderImage&&(e='<img src="'+settings.loaderImage+'" width="24">  '),t(settings.containerWrapper).html('<div class="text-center">'+e+"Searching..</div>")},success:function(t){setTimeout(function(){displayContent(t)},settings.delay)}})},toggleContainer=function(){return i.val().length>0?t(settings.containerWrapper).fadeIn(settings.fadeIn):t(settings.containerWrapper).fadeOut(settings.fadeOut),!0},displayContent=function(e){var i="";if("object"==typeof e?(t.each(e,function(t,e){"object"==typeof e?settings.format.length>0&&(i+=doFormat(e)):(console.log("Not an object"),console.log(e),i+=e)}),t(settings.containerWrapper).html(i)):t(settings.containerWrapper).html(e),0==e.length){console.log(e.length);var n;n='<div><span class="glyphicon glyphicon-exclamation-sign"></span> No data found. Please try other keywords.</div>',n+='<div style="margin-top: 10px;"></div>',n+='<div style="font-size:11px;">Please try this format recommended by the system:</div>',n+='<div class="text-center">Lastname Firstname [Format]</div>',t(settings.containerWrapper).html(n)}},doFormat=function(t){for(var e="",i="<"+settings.fieldTag+' class="searchItem">',n="<"+settings.fieldTag+"/>",s=settings.format,a=s.split(":").length-1,r=a;r>=0;r--)s=s.replace(":"," ");var o=new RegExp(Object.keys(t).join("|"),"gi");if(s=s.replace(o,function(e){return t[e]}),settings.urlWithID===!0){var l,g='<a href="'+settings.url+getURI(t)+'" style="font-size: 14px;">',d="</a>";l=""==settings.itemIcon?"":""!=t.image?'<img src="'+t.image+'" width="40"> ':'<img src="'+settings.itemIcon+'" width="40"> ',e+=i+g+l+s+d+n+'<div class="separator"></div>'}else e+=i+s+n;return e},getURI=function(t){var e;return void 0===t[settings.idField]&&console.log("The data doesn't exists. "),("?"==settings.idSeparator||"&"==settings.idSeparator)&&(e=settings.idSeparator+settings.idField+"="+t[settings.idField]),"/"==settings.idSeparator&&(e=settings.idSeparator+t[settings.idField]),e},i.on(settings.keyEvent,function(e){return 27==e.keyCode?(t("#main_search_result").fadeOut(250),!1):(t(this).val().length>2&&beginSearch(),t(this).val().length<2?(t("#main_search_result").fadeOut(250),!1):(e.preventDefault(),void 0))})}}(jQuery);